# Скальперский привод для Quik

![Интерфейс привода](img/interface.png "Интерфейс привода")

Небольшой скальперский привод на чистом LUA, без использования сторонних языков. Задумывался скорее как заготовка для дальнейшей автоматизации действий. Состоит из двух таблиц, поскольку Quik не предоставляет других элементов интерфейса. Основное окно(справа) содержит два стакана, по фьючерсу и по акции, цены в них смещены на контанго, вычисленное при старте скрипта. Слева от каждого стакана показываются сделки, разделенные на покупки и продажи, так удобнее отслеживать, кто проявляет большую активность, продавцы или покупатели. По умолчанию интервал стирания сделок 60 сек, или при центрировании или прокрутке стакана клавишами. Сделки также записываются в правые нижние ячейки таблицы "Управление", и при стирании продвигаются влево.

В стакане на фьючерс также как и в стандартном "быстром" стакане можно поставить лимитки кликом на столбце покупки или продажи, размер будет соответствовать текущему рабочему объему, по умолчанию 1 контракт. Если цена лучше рыночной, то она исполнится биржей по рынку, если хуже, то лимитка будет висеть на своем месте. Заявка подсвечивается бирюзовым цветом в центре стакана, для снятия нужно щелкнуть на неё колесиком мыши. В данный момент подсвечивается только последняя введенная лимитка, поэтому лучше держать рядом таблицу с заявками, для контроля. Нажав, протянув и отпустив мышь в среднем ряду можно поставить стоп-заявку, она поставится в размере текущей открытой позиции. Нужно соблюдать направление протягивания, в сторону от входа. Там где нажата мышь соответственно будет цена срабатывания, там где отпущена будет цена заявки. Стоп будет подсвечен фиолетовым. При клике колесом на подсветку он будет снят, но выводится только один стоп, поэтому лучше держать рядом таблицу с стоп-заявками. Также можно выделить ячейку покупки или продажи, если кликнуть на неё скм. Так можно виртуально торговать или подсветить какие-то объёмы.

В стакане на акцию можно поставить подобие входа стоп-лимитом по другой бумаге. Подобие потому, что при создании нормальной заявки биржа отдавала ошибки случайным образом. При клике на среднем столбце акции будет подсвечен вход стопом в соответствии с направлением, где он поставлен. Если стакан дойдет до этой цены, то сработает вход по рынку на фьючерсе. Это не очень хорошо работает, позже будут сделаны различные варианты учитывающие сделки.

Также при фокусе на основном окне работают горячие клавиши:

|       Клавиша        |                Функция                 |
|----------------------|----------------------------------------|
|<kbd>w</kbd>          |  покупка по рынку                      |
|<kbd>s</kbd>          |  продажа по рынку                      |
|<kbd>a</kbd>          |  лимитка на покупку в спреде           |
|<kbd>d</kbd>          |  лимитка на продажу в спреде           |
|<kbd>0 (NumPad)</kbd> |  отцентрировать стакан                 |
|<kbd>Esc</kbd>        |  Снять все заявки                      |
|<kbd>Del</kbd>        |  Снять все заявки, и выйти по рынку    |
|<kbd>↑</kbd>          |  Прокрутка стакана на 15 пунктов вверх |
|<kbd>↓</kbd>          |  Прокрутка стакана на 15 пунктов вниз  |
|<kbd>1</kbd>          |  рабочий объем = 1 контракт            |
|<kbd>2</kbd>          |  рабочий объем = 2 контракта           |
|<kbd>3</kbd>          |  рабочий объем = 5 контрактов          |
|<kbd>4</kbd>          |  рабочий объем = 10 контрактов         |
|<kbd>5</kbd>          |  рабочий объем = 15 контрактов         |


- - - -

Более подробно описывать функционал нет смысла, он постоянно переписывается, поэтому лучше смотреть в коде, или дописывать нужные штуки под себя. Все файлы имеют кодировку cp-1251, потому, что в ней работает QUIK. Для запуска привода нужно создать файл настроек из **SRZ0_example.lua** и запустить его. Под каждую новую бумагу или терминал создается отдельный файл и запускается только он. Параметры для настроек можно взять из **tri**-файла сохраненного из кармана сделок.
